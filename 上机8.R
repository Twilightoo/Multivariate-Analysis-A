bank0<-read.table("D:/R-3.3.3/JohnsonWichern Data sets/T1-6.DAT")
m<-as.matrix(bank0)
NMS1<-m[1:69,1]
NMS2<-m[1:69,2]
NMS3<-m[1:69,3]
NMS4<-m[1:69,4]
NMS5<-m[1:69,5]
MS1<-m[70:98,1]
MS2<-m[70:98,2]
MS3<-m[70:98,3]
MS4<-m[70:98,4]
MS5<-m[70:98,5]
qqnorm(MS1)
qqnorm(NMS1)
qqnorm(MS2)
qqnorm(NMS2)
qqnorm(MS3)
qqnorm(NMS3)
qqnorm(MS4)
qqnorm(NMS4)
qqnorm(MS5)
qqnorm(NMS5)
qqnorm(log(MS1))
qqnorm(log(NMS1))
qqnorm(log(MS3+1))
qqnorm(log(NMS3+1))
qqnorm(log(MS5+1))
qqnorm(log(NMS5+1))
n1<-98-69
n2<-69
x1<-apply(m[70:98,-6],2,mean)
x2<-apply(m[1:69,-6],2,mean)
S1<-cov(m[70:98,-6])
S2<-cov(m[1:69,-6])
Sp<-(n1-1)/((n1-1)+(n2-1))*S1+(n2-1)/((n1-1)+(n2-1))*S2
y<-(x1-x2)%*%solve(Sp)
test<-1/2*(x1-x2)%*%solve(Sp)%*%(x1+x2)
A<-m[70:98,-6]%*%t(y)
B<-m[1:69,-6]%*%t(y)
n1M<-length(A[A<as.numeric(test)])
n1C<-n1-n1M
n2M<-length(B[B>as.numeric(test)])
n2C<-n2-n2M
APER<-(n1M+n2M)/(n1+n2)
i<-70
n1MH<-0
while(i<=98){
if(i==70){ 
x1temp<-apply(m[71:98,-6],2,mean)
S1temp<-cov(m[71:98,-6])
}
else{
if(i==98){
x1temp<-apply(m[70:97,-6],2,mean)
S1temp<-cov(m[70:97,-6])
}
else{
x1temp<-apply(m[c(70:(i-1),(i+1):98),-6],2,mean)
S1temp<-cov(m[c(70:(i-1),(i+1):98),-6])
}
}
Sptemp<-(n1-1)/((n1-1)+(n2-1))*S1temp+(n2-1)/((n1-1)+(n2-1))*S2
if(m[i,-6]%*%t((x1temp-x2)%*%solve(Sptemp))<1/2*(x1temp-x2)%*%solve(Sptemp)%*%(x1temp+x2)){
n1MH<-n1MH+1
}
i<-i+1
}
i<-1
n2MH<-0
while(i<=69){
if(i==1){ 
x2temp<-apply(m[2:69,-6],2,mean)
S2temp<-cov(m[2:69,-6])
}
else{
if(i==69){
x2temp<-apply(m[1:68,-6],2,mean)
S2temp<-cov(m[1:68,-6])
}
else{
x2temp<-apply(m[c(1:(i-1),(i+1):69),-6],2,mean)
S2temp<-cov(m[c(1:(i-1),(i+1):69),-6])
}
}
Sptemp<-(n1-1)/((n1-1)+(n2-1))*S1+(n2-1)/((n1-1)+(n2-1))*S2temp
if(m[i,-6]%*%t((x1-x2temp)%*%solve(Sptemp))>1/2*(x1-x2temp)%*%solve(Sptemp)%*%(x1+x2temp)){
n2MH<-n2MH+1
}
i<-i+1
}
EAER<-(n1MH+n2MH)/(n1+n2)





